{"version":3,"sources":["clAdapters/jira/index.js"],"names":["Adapter","url","request","JiraAdapter","protocol","apiVersion","port","prototype","makeRequest","path","uri","format","hostname","credentials","host","pathname","authorizationString","Buffer","email","password","toString","options","method","headers","resolve","reject","error","response","body","code","statusCode","message","data","success","getIssueHierarchy","runConnectionTest","testResult","errorMessage"],"mappings":";;;;;;;AAAA,OAAOA,OAAP,MAAoB,iBAApB;AACA,OAAOC,GAAP,MAAgB,KAAhB;AACA,OAAOC,OAAP,MAAoB,SAApB;;IAEqBC,W;;;AACnB,yBAAc;AAAA;;AAAA;;AAEZ,UAAKC,QAAL,GAAgB,OAAhB;AACA,UAAKC,UAAL,GAAkB,CAAlB;AACA,UAAKC,IAAL,GAAY,IAAZ;AAJY;AAKb;;;EANsCN,O;;eAApBG,W;;;AASrBA,YAAYI,SAAZ,CAAsBC,WAAtB,GAAoC,UAASC,IAAT,EAAe;AACjD,MAAMC,MAAMT,IAAIU,MAAJ,CAAW;AACrBP,cAAU,KAAKA,QADM;AAErBQ,cAAU,KAAKC,WAAL,CAAiBC,IAFN;AAGrBR,UAAM,KAAKA,IAHU;AAIrBS,cAAU,cAAc,KAAKV,UAAnB,GAAgC,GAAhC,GAAsCI;AAJ3B,GAAX,CAAZ;;AAOA,MAAMO,sBAAsB,IAAIC,MAAJ,CAAW,KAAKJ,WAAL,CAAiBK,KAAjB,GAAyB,GAAzB,GAA+B,KAAKL,WAAL,CAAiBM,QAA3D,EAAqEC,QAArE,CAA8E,QAA9E,CAA5B;;AAEA,MAAMC,UAAU;AACdX,SAAKA,GADS;AAEdY,YAAQ,KAFM;AAGdC,aAAS;AACP,uBAAiB,WAAWP;AADrB;AAHK,GAAhB;;AAQA,SAAO,aAAY,UAACQ,OAAD,EAAUC,MAAV,EAAqB;AACtCvB,YAAQmB,OAAR,EAAiB,UAACK,KAAD,EAAQC,QAAR,EAAkBC,IAAlB,EAA2B;AAC1C,UAAIF,KAAJ,EAAW;AACTD,eAAO;AACLI,gBAAMF,SAASG,UADV;AAELC,mBAASL,KAFJ;AAGLM,gBAAMJ,IAHD;AAILK,mBAAS;AAJJ,SAAP;AAMD,OAPD,MAOO;AACLT,gBAAQ;AACNK,gBAAMF,SAASG,UADT;AAENE,gBAAMJ,IAFA;AAGNK,mBAAS;AAHH,SAAR;AAKD;AACF,KAfD;AAgBD,GAjBM,CAAP;AAkBD,CApCD;;AAsCA9B,YAAYI,SAAZ,CAAsB2B,iBAAtB,8CAA0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAC3B,KAAK1B,WAAL,CAAiB,kBAAjB,CAD2B;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1C;;AAIAL,YAAYI,SAAZ,CAAsB4B,iBAAtB,8CAA0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBACf,KAAK3B,WAAL,CAAiB,QAAjB,CADe;;AAAA;AAClC4B,oBADkC;;AAExC,cAAIA,WAAWP,IAAX,KAAoB,GAAxB,EAA6B;AAC3BO,uBAAWC,YAAX,GAA0B,2BAA1B;AACAD,uBAAWH,OAAX,GAAqB,KAArB;AACD;AALuC,4CAMjCG,UANiC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAA1C","file":"clAdapters/jira/index.js","sourcesContent":["import Adapter from '../base/Adapter';\nimport url from 'url';\nimport request from 'request';\n\nexport default class JiraAdapter extends Adapter {\n  constructor() {\n    super();\n    this.protocol = 'https';\n    this.apiVersion = 2;\n    this.port = null;\n  }\n}\n\nJiraAdapter.prototype.makeRequest = function(path) {\n  const uri = url.format({\n    protocol: this.protocol,\n    hostname: this.credentials.host,\n    port: this.port,\n    pathname: 'rest/api/' + this.apiVersion + '/' + path\n  });\n\n  const authorizationString = new Buffer(this.credentials.email + ':' + this.credentials.password).toString('base64');\n\n  const options = {\n    uri: uri,\n    method: 'GET',\n    headers: {\n      'Authorization': 'Basic ' + authorizationString\n    }\n  };\n\n  return new Promise((resolve, reject) => {\n    request(options, (error, response, body) => {\n      if (error) {\n        reject({\n          code: response.statusCode,\n          message: error,\n          data: body,\n          success: false\n        });\n      } else {\n        resolve({\n          code: response.statusCode,\n          data: body,\n          success: true\n        });\n      }\n    });\n  });\n};\n\nJiraAdapter.prototype.getIssueHierarchy = async function() {\n  return await this.makeRequest('issue/createmeta');\n};\n\nJiraAdapter.prototype.runConnectionTest = async function() {\n  const testResult = await this.makeRequest('myself');\n  if (testResult.code === 401) {\n    testResult.errorMessage = 'Failed to authorize user.';\n    testResult.success = false;\n  }\n  return testResult;\n};\n"],"sourceRoot":"/source/"}